---
title: "**MINVAL** - **MIN**imal **VAL**idation for Stoichiometric Reactions"
author: "Daniel Osorio, Janneth Gonzalez PhD. and Andrés Pinzón-Velasco PhD."
date: "`r Sys.Date()`"
output:
  pdf_document:
  toc: true
  geometry: margin=1in
---
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{MINVAL - MINimal VALidation for Stoichiometric Reactions}
-->
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Introduction to MINVAL
The **MINVAL** package was designed as a tool to identify orphan metabolites and evaluate the mass and charge balance of stoichometric reactions. MINVAL also includes functions to write models in TSV and SBML formats, extract all reactants, products, metabolite names and compartments from a metabolic reconstruction.

## Getting started
```{r message=FALSE}
library("minval")
library("sybilSBML")
```

```{r}
glycolysis <- read.csv2(system.file("extdata", "glycolysisKEGG.csv", package = "minval"),
                        stringsAsFactors = FALSE)
colnames(glycolysis)
```

```{r}
head(glycolysis$REACTION)
```

```{r}
valid <- isValidSyntax(glycolysis$REACTION)
valid
```

```{r}
mapReactions(reactionList = valid,
             referenceData = glycolysis,
             by = "bool",
             inverse = TRUE)
```

```{r}
glycolysis$REACTION[12] <- "D-Glyceraldehyde 3-phosphate[c] <=> Glycerone phosphate[c]"
glycolysis$REACTION[16] <- "2-Phospho-D-glycerate[c] <=> 3-Phospho-D-glycerate[c]"
isValidSyntax(glycolysis$REACTION)
```

```{r message=FALSE}
convert2sbml(glycolysis,"glycolysis.xml")
glycoModel <- readSBMLmod("glycolysis.xml")
glycoModel
optimizeProb(glycoModel)
```

```{r}
chemicalData <- read.csv2(system.file("extdata", "chemData.csv", package = "minval"))
head(chemicalData)
```

```{r}
balanced <- isBalanced(reactionList = glycolysis$REACTION,
                       referenceData = chemicalData,
                       ids = "NAME",
                       mFormula = "FORMULA")
balanced

```

```{r}
mapReactions(reactionList = balanced,
             referenceData = glycolysis,
             by = "bool",
             inverse = TRUE)
```

```{r}
glycolysis$REACTION[13] <- "D-Glyceraldehyde 3-phosphate[c] + Orthophosphate[c] + NAD+[c] => 3-Phospho-D-glyceroyl phosphate[c] + NADH[c] + H+[c]"
glycolysis$REACTION[17] <- "alpha-D-Glucose[c] + Orthophosphate[c] => alpha-D-Glucose 6-phosphate[c] + H2O[c]"
isBalanced(reactionList = glycolysis$REACTION,
                       referenceData = chemicalData,
                       ids = "NAME",
                       mFormula = "FORMULA")
```
```{r message=FALSE}
convert2sbml(glycolysis,"glycolysisCurated.xml")
glycoModel <- readSBMLmod("glycolysisCurated.xml")
glycoModel
optimizeProb(glycoModel)
```